{
  "checks": [
    {
      "id": 1,
      "lessonIds": [6],
      "trigger": "Adding a cross-cutting concern (CSRF, auth headers) without auditing all existing fetch calls",
      "triggerKeywords": ["fetch", "csrf", "headers", "post", "patch", "delete", "mutation"],
      "check": "When adding a cross-cutting header requirement, audit ALL existing client-side fetch calls. Search for method: 'POST'|'PATCH'|'DELETE' and verify each includes the required header.",
      "checkType": "grep",
      "grepPattern": "method:\\s*['\"](?:POST|PATCH|DELETE)['\"]",
      "status": "active",
      "proposedAt": "2026-02-19T12:00:00.000Z",
      "approvedAt": "2026-02-19T12:00:00.000Z",
      "catches": 0,
      "falsePositives": 0,
      "demotedAt": null,
      "demotionReason": null
    },
    {
      "id": 2,
      "lessonIds": [11],
      "trigger": "Error handler that catches and breaks without surfacing the error in any observable way",
      "triggerKeywords": ["catch", "error", "silent", "swallow", "empty", "break"],
      "check": "Never catch-and-break without surfacing the error. Every catch block must either re-throw, log to a result object, or return an error response. Empty catch blocks are forbidden.",
      "checkType": "grep",
      "grepPattern": "catch\\s*\\{\\s*\\}|catch\\s*\\([^)]*\\)\\s*\\{\\s*\\}",
      "status": "active",
      "proposedAt": "2026-02-19T12:00:00.000Z",
      "approvedAt": "2026-02-19T12:00:00.000Z",
      "catches": 0,
      "falsePositives": 0,
      "demotedAt": null,
      "demotionReason": null
    },
    {
      "id": 3,
      "lessonIds": [13],
      "trigger": "Using process.cwd() or relative paths for config file loading in MCP server or subprocess scripts",
      "triggerKeywords": ["cwd", "dotenv", "config", "env", "path", "subprocess", "dirname"],
      "check": "Always use __dirname-relative paths for config file loading in MCP servers and cron scripts. Never rely on process.cwd() - the parent process controls the working directory.",
      "checkType": "grep",
      "grepPattern": "dotenv.*config\\(\\)|process\\.cwd\\(\\)",
      "status": "active",
      "proposedAt": "2026-02-19T12:00:00.000Z",
      "approvedAt": "2026-02-19T12:00:00.000Z",
      "catches": 0,
      "falsePositives": 0,
      "demotedAt": null,
      "demotionReason": null
    },
    {
      "id": 4,
      "lessonIds": [16],
      "trigger": "Using vi.resetAllMocks() in afterEach which destroys factory-defined mock implementations",
      "triggerKeywords": ["resetallmocks", "vitest", "mock", "aftereach", "factory", "vi"],
      "check": "Never use vi.resetAllMocks() in afterEach - it destroys factory-level mock implementations. Use vi.clearAllMocks() in beforeEach instead, and re-establish mock return values there.",
      "checkType": "grep",
      "grepPattern": "afterEach.*resetAllMocks|vi\\.resetAllMocks\\(\\)",
      "status": "active",
      "proposedAt": "2026-02-19T12:00:00.000Z",
      "approvedAt": "2026-02-19T12:00:00.000Z",
      "catches": 0,
      "falsePositives": 0,
      "demotedAt": null,
      "demotionReason": null
    },
    {
      "id": 5,
      "lessonIds": [9],
      "trigger": "Writing enforcement logic (iron laws, checks, validation) that is never wired into an execution path",
      "triggerKeywords": ["enforce", "check", "guard", "validate", "hook", "wire", "dead", "unused"],
      "check": "After writing any enforcement or validation logic, verify it is actually called from an execution path (MCP tool handler, hook script, API middleware). Dead enforcement code provides zero value.",
      "checkType": "manual",
      "grepPattern": null,
      "status": "active",
      "proposedAt": "2026-02-19T12:00:00.000Z",
      "approvedAt": "2026-02-19T12:00:00.000Z",
      "catches": 0,
      "falsePositives": 0,
      "demotedAt": null,
      "demotionReason": null
    },
    {
      "id": 6,
      "lessonIds": [12],
      "trigger": "Rebuilding after deleting or renaming source files without cleaning dist/ directory first",
      "triggerKeywords": ["dist", "build", "delete", "rename", "refactor", "stale", "artifact"],
      "check": "After major refactors that delete or rename source files, always clean dist/ before rebuilding. Old compiled artifacts persist even when source is deleted. Run 'rm -rf dist' before 'npm run build'.",
      "checkType": "manual",
      "grepPattern": null,
      "status": "active",
      "proposedAt": "2026-02-19T12:00:00.000Z",
      "approvedAt": "2026-02-19T12:00:00.000Z",
      "catches": 0,
      "falsePositives": 0,
      "demotedAt": null,
      "demotionReason": null
    }
  ]
}
